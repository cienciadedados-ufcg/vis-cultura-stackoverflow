---
title: "Ramon Nóbrega-comentarios-e-cultura"
author: "Ramon Nóbrega dos Santos"
date: "19 de maio de 2020"
output:
    html_document:
    df_print: paged
theme: sandstone
---
    
    Ramon Nóbrega (Aluno especial- FPCC2 - 2020.1)

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(here)
library(viridis)
source(here::here("code/import_data.R"))
theme_set(theme_bw())

knitr::opts_chunk$set(tidy = FALSE,
                      fig.width = 6,
                      fig.height = 5)

library(extrafont)
# Só é preciso fazer isso uma única vez
extrafont::font_import()
extrafont::loadfonts()
```

```{r read}
dados = read_csv(
    here::here("data/participation-per-country.csv"),
    col_types = cols(
        .default = col_double(),
        site = col_character(),
        country = col_character(),
        geo = col_character(),
        four_regions = col_character(),
        eight_regions = col_character(),
        six_regions = col_character(),
        `World bank income group 2017` = col_character()
    )
) %>%
    filter(usuarios > 200)
glimpse(dados)
 ``` 

Estamos interessados na relação entre quanto as pessoas de diferentes países comentam em questões dos outros. A proporção das pessoas do país que comentou nas questões de outros está medido na variável `comentaram_prop`.

Considerando essa variável, queremos examinar a relação entre ela e o quão hierárquicas são as relações em um país (`PDI`). Queremos também levar em conta o quanto as pessoas daquele país têm acesso à Internet (`Internet`) e qual o tamanho da base de dados que detectamos daquele país (`usuarios`).

Faça uma visualização que usa os princípios de eficácia no projeto de visualizações para facilitar as comparações que você acha que são as mais importantes para entendermos esse contexto.

## Examinando essa relação
Analisando a questão acima, é solicitada a investigação da relação entre quatro variáveis: PDI, comentaram_prop, Internet e usuarios.
Para isso, a melhor forma de integrar todas elas é a partir de um gŕafico em que no eixo X tenha a variável PDI e no eixo Y a variável comentam_prop. A partir daí, podemos verificar como essas duas grandezas se relacionam. Também incluiremos as variáveis Internet e quantidade de usuários.

 ```{r}
dados %>%
    ggplot(aes(
        x = PDI,
        y = comentaram_prop,
        color = Internet,
        size = log10(usuarios),
        
    )) +
    geom_point(alpha = .6)+
    theme_light()+
    theme(plot.title = element_text(size = 10,face="bold",family="Times new Roman")) +
    labs(
        title = "Relação entre os Usuários, seus comentários, PDI e acesso à Internet",
        position="plot",
        x = "Índice de Distância de Poder (PDI)" ,
        y = "Porcentagem de usuários que comentam"
       
    )
 
```

Pela análise do gráfico acima, percebemos que, de forma geral, existe uma relação inversamente proporcional entre a PDI e a comentaram_prop.
Ou seja, países que possuem as relações hierárquicas menos engessadas,
com menores PDI, os seus usuários são os que mais comentam. Já países com os maiores PDI, aqueles que seus habitantes acham normal as desigualdades e a hierarquia, comentam menos.Também é possível observar que países com menores PDI possuem mais acesso à internet. De forma geral, países com populações menores comentam menos do que países com populações maiores.

Percebemos também que pela coloração das bolas mais claras dos países que possuem mais acesso à internet, os seus usuários comentam mais. Isso se deve a ter estruturas sociais mais democráticas. Com relação a quantidade de usuários das
plataformas, de forma geral, percebe-se uma relação proporcional entre o número de usuários e a quantidade de comentários.


## Outras formas de ver

Em seguida, faça 5 visualizações que usem as mesmas variáveis e também pontos, mas que sejam **menos eficazes** que a que você escolheu acima.

Artigo tomando como referência:
6 dicas para a visualização de dados disponível em
https://www.ibpad.com.br/blog/analise-de-dados/6-dicas-para-visualizacao-de-dados/


**ANÁLISE DO GRÁFICO 1**
A primeira análise que faremos é baseada na **utilização de temas que tem uma relação ruim com as demais cores **. Perceba que a utilização do tema dark deixa o gráfico com uma dificuldade para enxergar valores mais escuros do azul que se confundem com os do cinza.

 ```{r}
dados %>%
    ggplot(aes(
        x = PDI,
        y = comentaram_prop,
        color = Internet,
        size = log10(usuarios)
    )) +
    geom_point(alpha = .6)+
    theme_dark()+ 
    theme(plot.title = element_text(size = 10,face="bold")) +
    labs(
        title = "Relação entre os Usuários, seus comentários, PDI e acesso à Internet",
        position="plot",
        x = "Índice de Distância de Poder (PDI)",
        y = "Porcentagem de usuários que comentam"
       
    )
 ```

**ANÁLISE DO GRÁFICO 2**
A segunda análise que faremos é baseada no **excesso de cores em um gráfico**. Estudos mostram que o excesso de cor pode confundir o visualizador. Perceba
que pela visualização do gráfico fica difícil visualizar os países que possuem
menos acesso à internet devido a grande quantidade de cores diferentes.

 ```{r}
dados %>%
    ggplot(aes(
        x = PDI,
        y = comentaram_prop,
        color = Internet,
        size = log10(usuarios)
    )) +
    geom_point(alpha = .6)+
    scale_colour_gradientn(colours=rainbow(4)) +
    theme(plot.title = element_text(size = 10,face="bold")) +
    labs(
        title = "Relação entre os Usuários, seus comentários, PDI e acesso à Internet",
        position="plot",
        x = "Índice de Distância de Poder (PDI)",
        y = "Porcentagem de usuários que comentam"
       
    )
 ```

**ANÁLISE DO GRÁFICO 3**
A terceira análise que faremos é baseada na **escolha das variáveis equivocadas**.
Nos eixo X e Y devem estar as variáveis mais importantes para a análise. Dessa forma, para constatar essa hipótese, serão mudadas as variáveis x e size: a variável x que antes era o PDI será a Internet e a variável y que antes era PDI será os usuários. Perceba que não é possível visualizar de forma clara a relação entre as variáveis PDI e a porcentagem de usuários devido a não correspondência visual entre tamanho das bolas e cores.

 ```{r}
grafico3<-dados %>%
    ggplot(aes(
        x = Internet,
        y = comentaram_prop,
        color = log10(usuarios),
        size = PDI
    )) +
    geom_point(alpha = .6)+
    theme(plot.title = element_text(size = 10,face="bold")) +
    labs(
        title = "Relação entre os Usuários, seus comentários, PDI e acesso à Internet",
        position="plot",
        x = "Internet" ,
        y = "Porcentagem de usuários que comentam"
       
    )
```

**ANÁLISE DO GRÁFICO 4**
A quarta análise que faremos é baseada na **utilização de fontes ilegíveis**. Parece uma dica tão óbvia, mas o uso de fontes regularmente é uma fonte de problemas numa visualização. Sabemos que Lobster é bonito, mas não significa que você deve usa-la num gráfico. Lembre-se, é uma narrativa, não é arte. 



**ANÁLISE DO GRÁFICO 5**
A quinta análise que faremos é baseada na **utilização de cores erradas para títulos e legendas**. Parece uma dica tão óbvia, mas o uso de fontes regularmente é uma fonte de problemas numa visualização. 

```{r}

grafico5<-dados %>%
    ggplot(aes(
        x = PDI,
        y = comentaram_prop,
        color = Internet,
        size = log10(usuarios),
        
    )) +
    geom_point(alpha = .6)+
    theme_light()+
    theme(plot.title = element_text(size = 10,face="bold",family="Times new Roman")) +
    labs(
        title = "Relação entre os Usuários, seus comentários, PDI e acesso à Internet",
        position="plot",
        x = "Índice de Distância de Poder (PDI)" ,
        y = "Porcentagem de usuários que comentam"
       
    )
#adicionando mais características as legendas
#https://socviz.co/refineplots.html
grafico5 + theme(legend.position = "top",
           plot.title = element_text(size=rel(1),
                                     lineheight=.5,
                                     family="Times",
                                     face="bold.italic",
                                     colour="yellow"),
           axis.text.x = element_text(size=rel(1.1),
                                      family="Courier",
                                      face="bold",
                                      color="yellow"),
           axis.text.y = element_text(size=rel(1.1),
                                      family="Courier",
                                      face="bold",
                                      color="yellow")
           
           )

grafico5

``` 

Bônus
Inclua o continente dos países (`six_regions`) na visualização.

```{r}
dados %>%
    filter(!is.na(six_regions))%>%
    ggplot(aes(
        x = PDI,
        y = comentaram_prop,
        size = Internet,
        color = log10(usuarios)
    )) +
    geom_point(alpha = .6) +
    facet_wrap(six_regions ~ ., scales = "free_y",ncol=2)+
    theme(plot.title = element_text(size = 10, face = "bold")) +
    labs(
        title = "Relação entre os Usuários, seus comentários, PDI e acesso à Internet",
        subtitle = "Por continente",
        x = "PDI",
        y = "Porcentagem de usuários que comentam"
        
    )
```


A partir da análise do gráfico acima, percebemos que os maiores índices
de comentários estão nos países da Europa.

 
